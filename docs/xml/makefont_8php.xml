<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.16">
  <compounddef id="makefont_8php" kind="file" language="PHP">
    <compoundname>makefont.php</compoundname>
      <sectiondef kind="func">
      <memberdef kind="function" id="makefont_8php_1a971f74d77a96a0c72721e33b05a31913" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>Message</definition>
        <argsstring>($txt, $severity=&apos;&apos;)</argsstring>
        <name>Message</name>
        <param>
          <declname>$txt</declname>
        </param>
        <param>
          <declname>$severity</declname>
          <defval>&apos;&apos;</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/var/www/html/trabajos/hospital/makefont/makefont.php" line="12" column="10" bodyfile="/var/www/html/trabajos/hospital/makefont/makefont.php" bodystart="12" bodyend="26"/>
      </memberdef>
      <memberdef kind="function" id="makefont_8php_1a350da5601143252db250f7bf3ca2c5c6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>Notice</definition>
        <argsstring>($txt)</argsstring>
        <name>Notice</name>
        <param>
          <declname>$txt</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/var/www/html/trabajos/hospital/makefont/makefont.php" line="28" column="10" bodyfile="/var/www/html/trabajos/hospital/makefont/makefont.php" bodystart="28" bodyend="31"/>
      </memberdef>
      <memberdef kind="function" id="makefont_8php_1ac3b83e4bc83ff322cbd88f70f269e7c2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>Warning</definition>
        <argsstring>($txt)</argsstring>
        <name>Warning</name>
        <param>
          <declname>$txt</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/var/www/html/trabajos/hospital/makefont/makefont.php" line="33" column="10" bodyfile="/var/www/html/trabajos/hospital/makefont/makefont.php" bodystart="33" bodyend="36"/>
      </memberdef>
      <memberdef kind="function" id="makefont_8php_1a8fb508c3ca3ccca6f318cb26631edfd4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>Error</definition>
        <argsstring>($txt)</argsstring>
        <name>Error</name>
        <param>
          <declname>$txt</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/var/www/html/trabajos/hospital/makefont/makefont.php" line="38" column="10" bodyfile="/var/www/html/trabajos/hospital/makefont/makefont.php" bodystart="38" bodyend="42"/>
      </memberdef>
      <memberdef kind="function" id="makefont_8php_1a2fc077176f6f32e1885532112cc1a01f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>LoadMap</definition>
        <argsstring>($enc)</argsstring>
        <name>LoadMap</name>
        <param>
          <declname>$enc</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/var/www/html/trabajos/hospital/makefont/makefont.php" line="44" column="10" bodyfile="/var/www/html/trabajos/hospital/makefont/makefont.php" bodystart="44" bodyend="60"/>
      </memberdef>
      <memberdef kind="function" id="makefont_8php_1a2316f5fcce6f314ed2eb4fc3426c0c4a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>GetInfoFromTrueType</definition>
        <argsstring>($file, $embed, $subset, $map)</argsstring>
        <name>GetInfoFromTrueType</name>
        <param>
          <declname>$file</declname>
        </param>
        <param>
          <declname>$embed</declname>
        </param>
        <param>
          <declname>$subset</declname>
        </param>
        <param>
          <declname>$map</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/var/www/html/trabajos/hospital/makefont/makefont.php" line="62" column="10" bodyfile="/var/www/html/trabajos/hospital/makefont/makefont.php" bodystart="62" bodyend="122"/>
      </memberdef>
      <memberdef kind="function" id="makefont_8php_1a4dee0951be5f4f2e9333a709eca3096a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>GetInfoFromType1</definition>
        <argsstring>($file, $embed, $map)</argsstring>
        <name>GetInfoFromType1</name>
        <param>
          <declname>$file</declname>
        </param>
        <param>
          <declname>$embed</declname>
        </param>
        <param>
          <declname>$map</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/var/www/html/trabajos/hospital/makefont/makefont.php" line="124" column="10" bodyfile="/var/www/html/trabajos/hospital/makefont/makefont.php" bodystart="124" bodyend="216"/>
      </memberdef>
      <memberdef kind="function" id="makefont_8php_1a2741a34186d086acfeb6b2899646381e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>MakeFontDescriptor</definition>
        <argsstring>($info)</argsstring>
        <name>MakeFontDescriptor</name>
        <param>
          <declname>$info</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/var/www/html/trabajos/hospital/makefont/makefont.php" line="218" column="10" bodyfile="/var/www/html/trabajos/hospital/makefont/makefont.php" bodystart="218" bodyend="253"/>
      </memberdef>
      <memberdef kind="function" id="makefont_8php_1a2003a94dff4192e37e37c6b7cabc9da8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>MakeWidthArray</definition>
        <argsstring>($widths)</argsstring>
        <name>MakeWidthArray</name>
        <param>
          <declname>$widths</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/var/www/html/trabajos/hospital/makefont/makefont.php" line="255" column="10" bodyfile="/var/www/html/trabajos/hospital/makefont/makefont.php" bodystart="255" bodyend="276"/>
      </memberdef>
      <memberdef kind="function" id="makefont_8php_1a6a51afba9135056d951a104d55f6af12" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>MakeFontEncoding</definition>
        <argsstring>($map)</argsstring>
        <name>MakeFontEncoding</name>
        <param>
          <declname>$map</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/var/www/html/trabajos/hospital/makefont/makefont.php" line="278" column="10" bodyfile="/var/www/html/trabajos/hospital/makefont/makefont.php" bodystart="278" bodyend="295"/>
      </memberdef>
      <memberdef kind="function" id="makefont_8php_1a15b0b7223a5713a1d99dffe60f5e4393" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>MakeUnicodeArray</definition>
        <argsstring>($map)</argsstring>
        <name>MakeUnicodeArray</name>
        <param>
          <declname>$map</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/var/www/html/trabajos/hospital/makefont/makefont.php" line="297" column="10" bodyfile="/var/www/html/trabajos/hospital/makefont/makefont.php" bodystart="297" bodyend="340"/>
      </memberdef>
      <memberdef kind="function" id="makefont_8php_1abd2121a3e400e1df96d0dac02ade77a2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>SaveToFile</definition>
        <argsstring>($file, $s, $mode)</argsstring>
        <name>SaveToFile</name>
        <param>
          <declname>$file</declname>
        </param>
        <param>
          <declname>$s</declname>
        </param>
        <param>
          <declname>$mode</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/var/www/html/trabajos/hospital/makefont/makefont.php" line="342" column="10" bodyfile="/var/www/html/trabajos/hospital/makefont/makefont.php" bodystart="342" bodyend="349"/>
      </memberdef>
      <memberdef kind="function" id="makefont_8php_1a1772e90f25043c86be98c497ba40ecfd" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>MakeDefinitionFile</definition>
        <argsstring>($file, $type, $enc, $embed, $subset, $map, $info)</argsstring>
        <name>MakeDefinitionFile</name>
        <param>
          <declname>$file</declname>
        </param>
        <param>
          <declname>$type</declname>
        </param>
        <param>
          <declname>$enc</declname>
        </param>
        <param>
          <declname>$embed</declname>
        </param>
        <param>
          <declname>$subset</declname>
        </param>
        <param>
          <declname>$map</declname>
        </param>
        <param>
          <declname>$info</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/var/www/html/trabajos/hospital/makefont/makefont.php" line="351" column="10" bodyfile="/var/www/html/trabajos/hospital/makefont/makefont.php" bodystart="351" bodyend="382"/>
      </memberdef>
      <memberdef kind="function" id="makefont_8php_1aeffe6f587a970747bc9df152f068f05b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>MakeFont</definition>
        <argsstring>($fontfile, $enc=&apos;cp1252&apos;, $embed=true, $subset=true)</argsstring>
        <name>MakeFont</name>
        <param>
          <declname>$fontfile</declname>
        </param>
        <param>
          <declname>$enc</declname>
          <defval>&apos;cp1252&apos;</defval>
        </param>
        <param>
          <declname>$embed</declname>
          <defval>true</defval>
        </param>
        <param>
          <declname>$subset</declname>
          <defval>true</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/var/www/html/trabajos/hospital/makefont/makefont.php" line="384" column="10" bodyfile="/var/www/html/trabajos/hospital/makefont/makefont.php" bodystart="384" bodyend="450"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="normal">&lt;?php</highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">/*******************************************************************************</highlight></codeline>
<codeline lineno="3"><highlight class="comment">*<sp/>Utility<sp/>to<sp/>generate<sp/>font<sp/>definition<sp/>files<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="4"><highlight class="comment">*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="5"><highlight class="comment">*<sp/>Version:<sp/>1.3<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="6"><highlight class="comment">*<sp/>Date:<sp/><sp/><sp/><sp/>2015-11-29<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="7"><highlight class="comment">*<sp/>Author:<sp/><sp/>Olivier<sp/>PLATHEY<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="8"><highlight class="comment">*******************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal">require(</highlight><highlight class="stringliteral">&apos;ttfparser.php&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="keyword">function</highlight><highlight class="normal"><sp/>Message($txt,<sp/>$severity=</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="13"><highlight class="normal">{</highlight></codeline>
<codeline lineno="14"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(PHP_SAPI==</highlight><highlight class="stringliteral">&apos;cli&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="15"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="16"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($severity)</highlight></codeline>
<codeline lineno="17"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>echo<sp/></highlight><highlight class="stringliteral">&quot;$severity:<sp/>&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="18"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>echo<sp/></highlight><highlight class="stringliteral">&quot;$txt\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="19"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="20"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="22"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($severity)</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>echo<sp/></highlight><highlight class="stringliteral">&quot;&lt;b&gt;$severity&lt;/b&gt;:<sp/>&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>echo<sp/></highlight><highlight class="stringliteral">&quot;$txt&lt;br&gt;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="26"><highlight class="normal">}</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="keyword">function</highlight><highlight class="normal"><sp/>Notice($txt)</highlight></codeline>
<codeline lineno="29"><highlight class="normal">{</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/>Message($txt,<sp/></highlight><highlight class="stringliteral">&apos;Notice&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="31"><highlight class="normal">}</highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="keyword">function</highlight><highlight class="normal"><sp/>Warning($txt)</highlight></codeline>
<codeline lineno="34"><highlight class="normal">{</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/>Message($txt,<sp/></highlight><highlight class="stringliteral">&apos;Warning&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="36"><highlight class="normal">}</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="keyword">function</highlight><highlight class="normal"><sp/>Error($txt)</highlight></codeline>
<codeline lineno="39"><highlight class="normal">{</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/>Message($txt,<sp/></highlight><highlight class="stringliteral">&apos;Error&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/>exit;</highlight></codeline>
<codeline lineno="42"><highlight class="normal">}</highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="keyword">function</highlight><highlight class="normal"><sp/>LoadMap($enc)</highlight></codeline>
<codeline lineno="45"><highlight class="normal">{</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/>$file<sp/>=<sp/>dirname(__FILE__).</highlight><highlight class="charliteral">&apos;/&apos;</highlight><highlight class="normal">.strtolower($enc).</highlight><highlight class="stringliteral">&apos;.map&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/>$a<sp/>=<sp/>file($file);</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(empty($a))</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Error(</highlight><highlight class="stringliteral">&apos;Encoding<sp/>not<sp/>found:<sp/>&apos;</highlight><highlight class="normal">.$enc);</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/>$map<sp/>=<sp/>array_fill(0,<sp/>256,<sp/>array(</highlight><highlight class="stringliteral">&apos;uv&apos;</highlight><highlight class="normal">=&gt;-1,<sp/></highlight><highlight class="stringliteral">&apos;name&apos;</highlight><highlight class="normal">=&gt;</highlight><highlight class="stringliteral">&apos;.notdef&apos;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">foreach</highlight><highlight class="normal">($a<sp/>as<sp/>$line)</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$e<sp/>=<sp/>explode(</highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">,<sp/>rtrim($line));</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$c<sp/>=<sp/>hexdec(substr($e[0],1));</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$uv<sp/>=<sp/>hexdec(substr($e[1],2));</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$name<sp/>=<sp/>$e[2];</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$map[$c]<sp/>=<sp/>array(</highlight><highlight class="stringliteral">&apos;uv&apos;</highlight><highlight class="normal">=&gt;$uv,<sp/></highlight><highlight class="stringliteral">&apos;name&apos;</highlight><highlight class="normal">=&gt;$name);</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>$map;</highlight></codeline>
<codeline lineno="60"><highlight class="normal">}</highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight><highlight class="keyword">function</highlight><highlight class="normal"><sp/>GetInfoFromTrueType($file,<sp/>$embed,<sp/>$subset,<sp/>$map)</highlight></codeline>
<codeline lineno="63"><highlight class="normal">{</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Return<sp/>information<sp/>from<sp/>a<sp/>TrueType<sp/>font</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$ttf<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classTTFParser" kindref="compound">TTFParser</ref>($file);</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$ttf-&gt;Parse();</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal">(Exception<sp/>$e)</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Error($e-&gt;getMessage());</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($embed)</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!$ttf-&gt;embeddable)</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Error(</highlight><highlight class="stringliteral">&apos;Font<sp/>license<sp/>does<sp/>not<sp/>allow<sp/>embedding&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($subset)</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$chars<sp/>=<sp/>array();</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">foreach</highlight><highlight class="normal">($map<sp/>as<sp/>$v)</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($v[</highlight><highlight class="stringliteral">&apos;name&apos;</highlight><highlight class="normal">]!=</highlight><highlight class="stringliteral">&apos;.notdef&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$chars[]<sp/>=<sp/>$v[</highlight><highlight class="stringliteral">&apos;uv&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$ttf-&gt;Subset($chars);</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[</highlight><highlight class="stringliteral">&apos;Data&apos;</highlight><highlight class="normal">]<sp/>=<sp/>$ttf-&gt;Build();</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[</highlight><highlight class="stringliteral">&apos;Data&apos;</highlight><highlight class="normal">]<sp/>=<sp/>file_get_contents($file);</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[</highlight><highlight class="stringliteral">&apos;OriginalSize&apos;</highlight><highlight class="normal">]<sp/>=<sp/>strlen($info[</highlight><highlight class="stringliteral">&apos;Data&apos;</highlight><highlight class="normal">]);</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/>$k<sp/>=<sp/>1000/$ttf-&gt;unitsPerEm;</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/>$info[</highlight><highlight class="stringliteral">&apos;FontName&apos;</highlight><highlight class="normal">]<sp/>=<sp/>$ttf-&gt;postScriptName;</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/>$info[</highlight><highlight class="stringliteral">&apos;Bold&apos;</highlight><highlight class="normal">]<sp/>=<sp/>$ttf-&gt;bold;</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/>$info[</highlight><highlight class="stringliteral">&apos;ItalicAngle&apos;</highlight><highlight class="normal">]<sp/>=<sp/>$ttf-&gt;italicAngle;</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/>$info[</highlight><highlight class="stringliteral">&apos;IsFixedPitch&apos;</highlight><highlight class="normal">]<sp/>=<sp/>$ttf-&gt;isFixedPitch;</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/>$info[</highlight><highlight class="stringliteral">&apos;Ascender&apos;</highlight><highlight class="normal">]<sp/>=<sp/>round($k*$ttf-&gt;typoAscender);</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/>$info[</highlight><highlight class="stringliteral">&apos;Descender&apos;</highlight><highlight class="normal">]<sp/>=<sp/>round($k*$ttf-&gt;typoDescender);</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/>$info[</highlight><highlight class="stringliteral">&apos;UnderlineThickness&apos;</highlight><highlight class="normal">]<sp/>=<sp/>round($k*$ttf-&gt;underlineThickness);</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/>$info[</highlight><highlight class="stringliteral">&apos;UnderlinePosition&apos;</highlight><highlight class="normal">]<sp/>=<sp/>round($k*$ttf-&gt;underlinePosition);</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/>$info[</highlight><highlight class="stringliteral">&apos;FontBBox&apos;</highlight><highlight class="normal">]<sp/>=<sp/>array(round($k*$ttf-&gt;xMin),<sp/>round($k*$ttf-&gt;yMin),<sp/>round($k*$ttf-&gt;xMax),<sp/>round($k*$ttf-&gt;yMax));</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/>$info[</highlight><highlight class="stringliteral">&apos;CapHeight&apos;</highlight><highlight class="normal">]<sp/>=<sp/>round($k*$ttf-&gt;capHeight);</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/>$info[</highlight><highlight class="stringliteral">&apos;MissingWidth&apos;</highlight><highlight class="normal">]<sp/>=<sp/>round($k*$ttf-&gt;glyphs[0][</highlight><highlight class="charliteral">&apos;w&apos;</highlight><highlight class="normal">]);</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/>$widths<sp/>=<sp/>array_fill(0,<sp/>256,<sp/>$info[</highlight><highlight class="stringliteral">&apos;MissingWidth&apos;</highlight><highlight class="normal">]);</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">foreach</highlight><highlight class="normal">($map<sp/>as<sp/>$c=&gt;$v)</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($v[</highlight><highlight class="stringliteral">&apos;name&apos;</highlight><highlight class="normal">]!=</highlight><highlight class="stringliteral">&apos;.notdef&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(isset($ttf-&gt;chars[$v[</highlight><highlight class="stringliteral">&apos;uv&apos;</highlight><highlight class="normal">]]))</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$id<sp/>=<sp/>$ttf-&gt;chars[$v[</highlight><highlight class="stringliteral">&apos;uv&apos;</highlight><highlight class="normal">]];</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$w<sp/>=<sp/>$ttf-&gt;glyphs[$id][</highlight><highlight class="charliteral">&apos;w&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$widths[$c]<sp/>=<sp/>round($k*$w);</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Warning(</highlight><highlight class="stringliteral">&apos;Character<sp/>&apos;</highlight><highlight class="normal">.$v[</highlight><highlight class="stringliteral">&apos;name&apos;</highlight><highlight class="normal">].</highlight><highlight class="stringliteral">&apos;<sp/>is<sp/>missing&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/>$info[</highlight><highlight class="stringliteral">&apos;Widths&apos;</highlight><highlight class="normal">]<sp/>=<sp/>$widths;</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>$info;</highlight></codeline>
<codeline lineno="122"><highlight class="normal">}</highlight></codeline>
<codeline lineno="123"><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight><highlight class="keyword">function</highlight><highlight class="normal"><sp/>GetInfoFromType1($file,<sp/>$embed,<sp/>$map)</highlight></codeline>
<codeline lineno="125"><highlight class="normal">{</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Return<sp/>information<sp/>from<sp/>a<sp/>Type1<sp/>font</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($embed)</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$f<sp/>=<sp/>fopen($file,<sp/></highlight><highlight class="stringliteral">&apos;rb&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!$f)</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Error(</highlight><highlight class="stringliteral">&apos;Can\&apos;t<sp/>open<sp/>font<sp/>file&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Read<sp/>first<sp/>segment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$a<sp/>=<sp/>unpack(</highlight><highlight class="stringliteral">&apos;Cmarker/Ctype/Vsize&apos;</highlight><highlight class="normal">,<sp/>fread($f,6));</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($a[</highlight><highlight class="stringliteral">&apos;marker&apos;</highlight><highlight class="normal">]!=128)</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Error(</highlight><highlight class="stringliteral">&apos;Font<sp/>file<sp/>is<sp/>not<sp/>a<sp/>valid<sp/>binary<sp/>Type1&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$size1<sp/>=<sp/>$a[</highlight><highlight class="stringliteral">&apos;size&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$data<sp/>=<sp/>fread($f,<sp/>$size1);</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Read<sp/>second<sp/>segment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$a<sp/>=<sp/>unpack(</highlight><highlight class="stringliteral">&apos;Cmarker/Ctype/Vsize&apos;</highlight><highlight class="normal">,<sp/>fread($f,6));</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($a[</highlight><highlight class="stringliteral">&apos;marker&apos;</highlight><highlight class="normal">]!=128)</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Error(</highlight><highlight class="stringliteral">&apos;Font<sp/>file<sp/>is<sp/>not<sp/>a<sp/>valid<sp/>binary<sp/>Type1&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$size2<sp/>=<sp/>$a[</highlight><highlight class="stringliteral">&apos;size&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$data<sp/>.=<sp/>fread($f,<sp/>$size2);</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fclose($f);</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[</highlight><highlight class="stringliteral">&apos;Data&apos;</highlight><highlight class="normal">]<sp/>=<sp/>$data;</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[</highlight><highlight class="stringliteral">&apos;Size1&apos;</highlight><highlight class="normal">]<sp/>=<sp/>$size1;</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[</highlight><highlight class="stringliteral">&apos;Size2&apos;</highlight><highlight class="normal">]<sp/>=<sp/>$size2;</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="149"><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/>$afm<sp/>=<sp/>substr($file,<sp/>0,<sp/>-3).</highlight><highlight class="stringliteral">&apos;afm&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!file_exists($afm))</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Error(</highlight><highlight class="stringliteral">&apos;AFM<sp/>font<sp/>file<sp/>not<sp/>found:<sp/>&apos;</highlight><highlight class="normal">.$afm);</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/>$a<sp/>=<sp/>file($afm);</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(empty($a))</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Error(</highlight><highlight class="stringliteral">&apos;AFM<sp/>file<sp/>empty<sp/>or<sp/>not<sp/>readable&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">foreach</highlight><highlight class="normal">($a<sp/>as<sp/>$line)</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$e<sp/>=<sp/>explode(</highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">,<sp/>rtrim($line));</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(count($e)&lt;2)</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$entry<sp/>=<sp/>$e[0];</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($entry==</highlight><highlight class="charliteral">&apos;C&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$w<sp/>=<sp/>$e[4];</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$name<sp/>=<sp/>$e[7];</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$cw[$name]<sp/>=<sp/>$w;</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elseif($entry==</highlight><highlight class="stringliteral">&apos;FontName&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[&apos;FontName&apos;]<sp/>=<sp/>$e[1];</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elseif($entry==&apos;Weight&apos;)</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[&apos;Weight&apos;]<sp/>=<sp/>$e[1];</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elseif($entry==&apos;ItalicAngle&apos;)</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[&apos;ItalicAngle&apos;]<sp/>=<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)$e[1];</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elseif($entry==&apos;Ascender&apos;)</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[&apos;Ascender&apos;]<sp/>=<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)$e[1];</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elseif($entry==&apos;Descender&apos;)</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[&apos;Descender&apos;]<sp/>=<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)$e[1];</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elseif($entry==&apos;UnderlineThickness&apos;)</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[&apos;UnderlineThickness&apos;]<sp/>=<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)$e[1];</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elseif($entry==&apos;UnderlinePosition&apos;)</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[&apos;UnderlinePosition&apos;]<sp/>=<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)$e[1];</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elseif($entry==&apos;IsFixedPitch&apos;)</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[&apos;IsFixedPitch&apos;]<sp/>=<sp/>($e[1]==&apos;true&apos;);</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elseif($entry==&apos;FontBBox&apos;)</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[&apos;FontBBox&apos;]<sp/>=<sp/>array((</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)$e[1],<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)$e[2],<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)$e[3],<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)$e[4]);</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elseif($entry==&apos;CapHeight&apos;)</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[&apos;CapHeight&apos;]<sp/>=<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)$e[1];</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elseif($entry==&apos;StdVW&apos;)</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[&apos;StdVW&apos;]<sp/>=<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)$e[1];</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="191"><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/>if(!isset($info[&apos;FontName&apos;]))</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Error(&apos;FontName<sp/>missing<sp/>in<sp/>AFM<sp/>file&apos;);</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/>if(!isset($info[&apos;Ascender&apos;]))</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[&apos;Ascender&apos;]<sp/>=<sp/>$info[&apos;FontBBox&apos;][3];</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/>if(!isset($info[&apos;Descender&apos;]))</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[&apos;Descender&apos;]<sp/>=<sp/>$info[&apos;FontBBox&apos;][1];</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/>$info[&apos;Bold&apos;]<sp/>=<sp/>isset($info[&apos;Weight&apos;])<sp/>&amp;&amp;<sp/>preg_match(&apos;/bold|black/i&apos;,<sp/>$info[&apos;Weight&apos;]);</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/>if(isset($cw[&apos;.notdef&apos;]))</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[&apos;MissingWidth&apos;]<sp/>=<sp/>$cw[&apos;.notdef&apos;];</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/>else</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[&apos;MissingWidth&apos;]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/>$widths<sp/>=<sp/>array_fill(0,<sp/>256,<sp/>$info[&apos;MissingWidth&apos;]);</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/>foreach($map<sp/>as<sp/>$c=&gt;$v)</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($v[</highlight><highlight class="stringliteral">&apos;name&apos;</highlight><highlight class="normal">]!=</highlight><highlight class="stringliteral">&apos;.notdef&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(isset($cw[$v[</highlight><highlight class="stringliteral">&apos;name&apos;</highlight><highlight class="normal">]]))</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$widths[$c]<sp/>=<sp/>$cw[$v[</highlight><highlight class="stringliteral">&apos;name&apos;</highlight><highlight class="normal">]];</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Warning(</highlight><highlight class="stringliteral">&apos;Character<sp/>&apos;</highlight><highlight class="normal">.$v[</highlight><highlight class="stringliteral">&apos;name&apos;</highlight><highlight class="normal">].</highlight><highlight class="stringliteral">&apos;<sp/>is<sp/>missing&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/>$info[</highlight><highlight class="stringliteral">&apos;Widths&apos;</highlight><highlight class="normal">]<sp/>=<sp/>$widths;</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>$info;</highlight></codeline>
<codeline lineno="216"><highlight class="normal">}</highlight></codeline>
<codeline lineno="217"><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"></highlight><highlight class="keyword">function</highlight><highlight class="normal"><sp/>MakeFontDescriptor($info)</highlight></codeline>
<codeline lineno="219"><highlight class="normal">{</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Ascent</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/>$fd<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;array(&apos;Ascent&apos;=&gt;&quot;</highlight><highlight class="normal">.$info[</highlight><highlight class="stringliteral">&apos;Ascender&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Descent</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/>$fd<sp/>.=<sp/></highlight><highlight class="stringliteral">&quot;,&apos;Descent&apos;=&gt;&quot;</highlight><highlight class="normal">.$info[</highlight><highlight class="stringliteral">&apos;Descender&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>CapHeight</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!empty($info[</highlight><highlight class="stringliteral">&apos;CapHeight&apos;</highlight><highlight class="normal">]))</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$fd<sp/>.=<sp/></highlight><highlight class="stringliteral">&quot;,&apos;CapHeight&apos;=&gt;&quot;</highlight><highlight class="normal">.$info[</highlight><highlight class="stringliteral">&apos;CapHeight&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$fd<sp/>.=<sp/></highlight><highlight class="stringliteral">&quot;,&apos;CapHeight&apos;=&gt;&quot;</highlight><highlight class="normal">.$info[</highlight><highlight class="stringliteral">&apos;Ascender&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Flags</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/>$flags<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($info[</highlight><highlight class="stringliteral">&apos;IsFixedPitch&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$flags<sp/>+=<sp/>1&lt;&lt;0;</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/>$flags<sp/>+=<sp/>1&lt;&lt;5;</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($info[</highlight><highlight class="stringliteral">&apos;ItalicAngle&apos;</highlight><highlight class="normal">]!=0)</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$flags<sp/>+=<sp/>1&lt;&lt;6;</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/>$fd<sp/>.=<sp/></highlight><highlight class="stringliteral">&quot;,&apos;Flags&apos;=&gt;&quot;</highlight><highlight class="normal">.$flags;</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>FontBBox</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/>$fbb<sp/>=<sp/>$info[</highlight><highlight class="stringliteral">&apos;FontBBox&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/>$fd<sp/>.=<sp/></highlight><highlight class="stringliteral">&quot;,&apos;FontBBox&apos;=&gt;&apos;[&quot;</highlight><highlight class="normal">.$fbb[0].</highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">.$fbb[1].</highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">.$fbb[2].</highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">.$fbb[3].</highlight><highlight class="stringliteral">&quot;]&apos;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ItalicAngle</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/>$fd<sp/>.=<sp/></highlight><highlight class="stringliteral">&quot;,&apos;ItalicAngle&apos;=&gt;&quot;</highlight><highlight class="normal">.$info[</highlight><highlight class="stringliteral">&apos;ItalicAngle&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>StemV</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(isset($info[</highlight><highlight class="stringliteral">&apos;StdVW&apos;</highlight><highlight class="normal">]))</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$stemv<sp/>=<sp/>$info[</highlight><highlight class="stringliteral">&apos;StdVW&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/>elseif($info[</highlight><highlight class="stringliteral">&apos;Bold&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$stemv<sp/>=<sp/>120;</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$stemv<sp/>=<sp/>70;</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/>$fd<sp/>.=<sp/></highlight><highlight class="stringliteral">&quot;,&apos;StemV&apos;=&gt;&quot;</highlight><highlight class="normal">.$stemv;</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>MissingWidth</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/>$fd<sp/>.=<sp/></highlight><highlight class="stringliteral">&quot;,&apos;MissingWidth&apos;=&gt;&quot;</highlight><highlight class="normal">.$info[</highlight><highlight class="stringliteral">&apos;MissingWidth&apos;</highlight><highlight class="normal">].</highlight><highlight class="charliteral">&apos;)&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>$fd;</highlight></codeline>
<codeline lineno="253"><highlight class="normal">}</highlight></codeline>
<codeline lineno="254"><highlight class="normal"></highlight></codeline>
<codeline lineno="255"><highlight class="normal"></highlight><highlight class="keyword">function</highlight><highlight class="normal"><sp/>MakeWidthArray($widths)</highlight></codeline>
<codeline lineno="256"><highlight class="normal">{</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/>$s<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;array(\n\t&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">($c=0;$c&lt;=255;$c++)</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(chr($c)==</highlight><highlight class="stringliteral">&quot;&apos;&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/></highlight><highlight class="stringliteral">&quot;&apos;\\&apos;&apos;&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elseif(chr($c)==</highlight><highlight class="stringliteral">&quot;\\&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/>&quot;&apos;\\\\&apos;&quot;;</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elseif($c&gt;=32<sp/>&amp;&amp;<sp/>$c&lt;=126)</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/>&quot;&apos;&quot;.chr($c).&quot;&apos;&quot;;</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>else</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/>&quot;chr($c)&quot;;</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/>&apos;=&gt;&apos;.$widths[$c];</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if($c&lt;255)</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/>&apos;,&apos;;</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if(($c+1)%22==0)</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/>&quot;\n\t&quot;;</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/>&apos;)&apos;;</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/>return<sp/>$s;</highlight></codeline>
<codeline lineno="276"><highlight class="normal">}</highlight></codeline>
<codeline lineno="277"><highlight class="normal"></highlight></codeline>
<codeline lineno="278"><highlight class="normal">function<sp/>MakeFontEncoding($map)</highlight></codeline>
<codeline lineno="279"><highlight class="normal">{</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Build<sp/>differences<sp/>from<sp/>reference<sp/>encoding</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/>$ref<sp/>=<sp/>LoadMap(</highlight><highlight class="stringliteral">&apos;cp1252&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/>$s<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/>$last<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">($c=32;$c&lt;=255;$c++)</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($map[$c][</highlight><highlight class="stringliteral">&apos;name&apos;</highlight><highlight class="normal">]!=$ref[$c][</highlight><highlight class="stringliteral">&apos;name&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($c!=$last+1)</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/>$c.</highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$last<sp/>=<sp/>$c;</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/></highlight><highlight class="charliteral">&apos;/&apos;</highlight><highlight class="normal">.$map[$c][</highlight><highlight class="stringliteral">&apos;name&apos;</highlight><highlight class="normal">].</highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rtrim($s);</highlight></codeline>
<codeline lineno="295"><highlight class="normal">}</highlight></codeline>
<codeline lineno="296"><highlight class="normal"></highlight></codeline>
<codeline lineno="297"><highlight class="normal"></highlight><highlight class="keyword">function</highlight><highlight class="normal"><sp/>MakeUnicodeArray($map)</highlight></codeline>
<codeline lineno="298"><highlight class="normal">{</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Build<sp/>mapping<sp/>to<sp/>Unicode<sp/>values</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/>$ranges<sp/>=<sp/>array();</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">foreach</highlight><highlight class="normal">($map<sp/>as<sp/>$c=&gt;$v)</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$uv<sp/>=<sp/>$v[</highlight><highlight class="stringliteral">&apos;uv&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($uv!=-1)</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(isset($range))</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($c==$range[1]+1<sp/>&amp;&amp;<sp/>$uv==$range[3]+1)</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$range[1]++;</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$range[3]++;</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$ranges[]<sp/>=<sp/>$range;</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$range<sp/>=<sp/>array($c,<sp/>$c,<sp/>$uv,<sp/>$uv);</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$range<sp/>=<sp/>array($c,<sp/>$c,<sp/>$uv,<sp/>$uv);</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/>$ranges[]<sp/>=<sp/>$range;</highlight></codeline>
<codeline lineno="324"><highlight class="normal"></highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">foreach</highlight><highlight class="normal">($ranges<sp/>as<sp/>$range)</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(isset($s))</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/></highlight><highlight class="charliteral">&apos;,&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$s<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;array(&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/>$range[0].</highlight><highlight class="stringliteral">&apos;=&gt;&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$nb<sp/>=<sp/>$range[1]-$range[0]+1;</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($nb&gt;1)</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/></highlight><highlight class="stringliteral">&apos;array(&apos;</highlight><highlight class="normal">.$range[2].</highlight><highlight class="charliteral">&apos;,&apos;</highlight><highlight class="normal">.$nb.</highlight><highlight class="charliteral">&apos;)&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/>$range[2];</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/></highlight><highlight class="charliteral">&apos;)&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>$s;</highlight></codeline>
<codeline lineno="340"><highlight class="normal">}</highlight></codeline>
<codeline lineno="341"><highlight class="normal"></highlight></codeline>
<codeline lineno="342"><highlight class="normal"></highlight><highlight class="keyword">function</highlight><highlight class="normal"><sp/>SaveToFile($file,<sp/>$s,<sp/>$mode)</highlight></codeline>
<codeline lineno="343"><highlight class="normal">{</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/>$f<sp/>=<sp/>fopen($file,<sp/></highlight><highlight class="charliteral">&apos;w&apos;</highlight><highlight class="normal">.$mode);</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!$f)</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Error(</highlight><highlight class="stringliteral">&apos;Can\&apos;t<sp/>write<sp/>to<sp/>file<sp/>&apos;</highlight><highlight class="normal">.$file);</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/>fwrite($f,<sp/>$s);</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/>fclose($f);</highlight></codeline>
<codeline lineno="349"><highlight class="normal">}</highlight></codeline>
<codeline lineno="350"><highlight class="normal"></highlight></codeline>
<codeline lineno="351"><highlight class="normal"></highlight><highlight class="keyword">function</highlight><highlight class="normal"><sp/>MakeDefinitionFile($file,<sp/>$type,<sp/>$enc,<sp/>$embed,<sp/>$subset,<sp/>$map,<sp/>$info)</highlight></codeline>
<codeline lineno="352"><highlight class="normal">{</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/>$s<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&lt;?php\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/></highlight><highlight class="stringliteral">&apos;$type<sp/>=<sp/>\&apos;&apos;</highlight><highlight class="normal">.$type.</highlight><highlight class="stringliteral">&quot;&apos;;\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/></highlight><highlight class="stringliteral">&apos;$name<sp/>=<sp/>\&apos;&apos;</highlight><highlight class="normal">.$info[</highlight><highlight class="stringliteral">&apos;FontName&apos;</highlight><highlight class="normal">].</highlight><highlight class="stringliteral">&quot;&apos;;\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/></highlight><highlight class="stringliteral">&apos;$desc<sp/>=<sp/>&apos;</highlight><highlight class="normal">.MakeFontDescriptor($info).</highlight><highlight class="stringliteral">&quot;;\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/></highlight><highlight class="stringliteral">&apos;$up<sp/>=<sp/>&apos;</highlight><highlight class="normal">.$info[</highlight><highlight class="stringliteral">&apos;UnderlinePosition&apos;</highlight><highlight class="normal">].</highlight><highlight class="stringliteral">&quot;;\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/></highlight><highlight class="stringliteral">&apos;$ut<sp/>=<sp/>&apos;</highlight><highlight class="normal">.$info[</highlight><highlight class="stringliteral">&apos;UnderlineThickness&apos;</highlight><highlight class="normal">].</highlight><highlight class="stringliteral">&quot;;\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/></highlight><highlight class="stringliteral">&apos;$cw<sp/>=<sp/>&apos;</highlight><highlight class="normal">.MakeWidthArray($info[</highlight><highlight class="stringliteral">&apos;Widths&apos;</highlight><highlight class="normal">]).</highlight><highlight class="stringliteral">&quot;;\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/></highlight><highlight class="stringliteral">&apos;$enc<sp/>=<sp/>\&apos;&apos;</highlight><highlight class="normal">.$enc.</highlight><highlight class="stringliteral">&quot;&apos;;\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/>$diff<sp/>=<sp/>MakeFontEncoding($map);</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($diff)</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/></highlight><highlight class="stringliteral">&apos;$diff<sp/>=<sp/>\&apos;&apos;</highlight><highlight class="normal">.$diff.</highlight><highlight class="stringliteral">&quot;&apos;;\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/></highlight><highlight class="stringliteral">&apos;$uv<sp/>=<sp/>&apos;</highlight><highlight class="normal">.MakeUnicodeArray($map).</highlight><highlight class="stringliteral">&quot;;\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($embed)</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/></highlight><highlight class="stringliteral">&apos;$file<sp/>=<sp/>\&apos;&apos;</highlight><highlight class="normal">.$info[</highlight><highlight class="stringliteral">&apos;File&apos;</highlight><highlight class="normal">].</highlight><highlight class="stringliteral">&quot;&apos;;\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($type==</highlight><highlight class="stringliteral">&apos;Type1&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/></highlight><highlight class="stringliteral">&apos;$size1<sp/>=<sp/>&apos;</highlight><highlight class="normal">.$info[</highlight><highlight class="stringliteral">&apos;Size1&apos;</highlight><highlight class="normal">].</highlight><highlight class="stringliteral">&quot;;\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/></highlight><highlight class="stringliteral">&apos;$size2<sp/>=<sp/>&apos;</highlight><highlight class="normal">.$info[</highlight><highlight class="stringliteral">&apos;Size2&apos;</highlight><highlight class="normal">].</highlight><highlight class="stringliteral">&quot;;\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/></highlight><highlight class="stringliteral">&apos;$originalsize<sp/>=<sp/>&apos;</highlight><highlight class="normal">.$info[</highlight><highlight class="stringliteral">&apos;OriginalSize&apos;</highlight><highlight class="normal">].</highlight><highlight class="stringliteral">&quot;;\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($subset)</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/></highlight><highlight class="stringliteral">&quot;\$subsetted<sp/>=<sp/>true;\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/>$s<sp/>.=<sp/></highlight><highlight class="stringliteral">&quot;?&gt;\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/>SaveToFile($file,<sp/>$s,<sp/></highlight><highlight class="charliteral">&apos;t&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="382"><highlight class="normal">}</highlight></codeline>
<codeline lineno="383"><highlight class="normal"></highlight></codeline>
<codeline lineno="384"><highlight class="normal"></highlight><highlight class="keyword">function</highlight><highlight class="normal"><sp/>MakeFont($fontfile,<sp/>$enc=</highlight><highlight class="stringliteral">&apos;cp1252&apos;</highlight><highlight class="normal">,<sp/>$embed=</highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/>$subset=</highlight><highlight class="keyword">true</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="385"><highlight class="normal">{</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Generate<sp/>a<sp/>font<sp/>definition<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(get_magic_quotes_runtime())</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>@set_magic_quotes_runtime(</highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/>ini_set(</highlight><highlight class="stringliteral">&apos;auto_detect_line_endings&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="charliteral">&apos;1&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="390"><highlight class="normal"></highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!file_exists($fontfile))</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Error(</highlight><highlight class="stringliteral">&apos;Font<sp/>file<sp/>not<sp/>found:<sp/>&apos;</highlight><highlight class="normal">.$fontfile);</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/>$ext<sp/>=<sp/>strtolower(substr($fontfile,-3));</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($ext==</highlight><highlight class="stringliteral">&apos;ttf&apos;</highlight><highlight class="normal"><sp/>||<sp/>$ext==</highlight><highlight class="stringliteral">&apos;otf&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$type<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;TrueType&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/>elseif($ext==</highlight><highlight class="stringliteral">&apos;pfb&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$type<sp/>=<sp/>&apos;Type1&apos;;</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/>else</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Error(&apos;Unrecognized<sp/>font<sp/>file<sp/>extension:<sp/>&apos;.$ext);</highlight></codeline>
<codeline lineno="400"><highlight class="normal"></highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/>$map<sp/>=<sp/>LoadMap($enc);</highlight></codeline>
<codeline lineno="402"><highlight class="normal"></highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/>if($type==&apos;TrueType&apos;)</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info<sp/>=<sp/>GetInfoFromTrueType($fontfile,<sp/>$embed,<sp/>$subset,<sp/>$map);</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/>else</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info<sp/>=<sp/>GetInfoFromType1($fontfile,<sp/>$embed,<sp/>$map);</highlight></codeline>
<codeline lineno="407"><highlight class="normal"></highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/>$basename<sp/>=<sp/>substr(basename($fontfile),<sp/>0,<sp/>-4);</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/>if($embed)</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(function_exists(</highlight><highlight class="stringliteral">&apos;gzcompress&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$file<sp/>=<sp/>$basename.</highlight><highlight class="stringliteral">&apos;.z&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SaveToFile($file,<sp/>gzcompress($info[</highlight><highlight class="stringliteral">&apos;Data&apos;</highlight><highlight class="normal">]),<sp/></highlight><highlight class="charliteral">&apos;b&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[</highlight><highlight class="stringliteral">&apos;File&apos;</highlight><highlight class="normal">]<sp/>=<sp/>$file;</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Message(</highlight><highlight class="stringliteral">&apos;Font<sp/>file<sp/>compressed:<sp/>&apos;</highlight><highlight class="normal">.$file);</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$info[</highlight><highlight class="stringliteral">&apos;File&apos;</highlight><highlight class="normal">]<sp/>=<sp/>basename($fontfile);</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$subset<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Notice(</highlight><highlight class="stringliteral">&apos;Font<sp/>file<sp/>could<sp/>not<sp/>be<sp/>compressed<sp/>(zlib<sp/>extension<sp/>not<sp/>available)&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="425"><highlight class="normal"></highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/>MakeDefinitionFile($basename.</highlight><highlight class="stringliteral">&apos;.php&apos;</highlight><highlight class="normal">,<sp/>$type,<sp/>$enc,<sp/>$embed,<sp/>$subset,<sp/>$map,<sp/>$info);</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/>Message(</highlight><highlight class="stringliteral">&apos;Font<sp/>definition<sp/>file<sp/>generated:<sp/>&apos;</highlight><highlight class="normal">.$basename.</highlight><highlight class="stringliteral">&apos;.php&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="428"><highlight class="normal">}</highlight></codeline>
<codeline lineno="429"><highlight class="normal"></highlight></codeline>
<codeline lineno="430"><highlight class="normal"></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(PHP_SAPI==</highlight><highlight class="stringliteral">&apos;cli&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="431"><highlight class="normal">{</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Command-line<sp/>interface</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/>ini_set(</highlight><highlight class="stringliteral">&apos;log_errors&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="charliteral">&apos;0&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($argc==1)</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>die(</highlight><highlight class="stringliteral">&quot;Usage:<sp/>php<sp/>makefont.php<sp/>fontfile<sp/>[encoding]<sp/>[embed]<sp/>[subset]\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/>$fontfile<sp/>=<sp/>$argv[1];</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($argc&gt;=3)</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$enc<sp/>=<sp/>$argv[2];</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$enc<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;cp1252&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($argc&gt;=4)</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$embed<sp/>=<sp/>($argv[3]==</highlight><highlight class="stringliteral">&apos;true&apos;</highlight><highlight class="normal"><sp/>||<sp/>$argv[3]==</highlight><highlight class="charliteral">&apos;1&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$embed<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($argc&gt;=5)</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$subset<sp/>=<sp/>($argv[4]==</highlight><highlight class="stringliteral">&apos;true&apos;</highlight><highlight class="normal"><sp/>||<sp/>$argv[4]==</highlight><highlight class="charliteral">&apos;1&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$subset<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/>MakeFont($fontfile,<sp/>$enc,<sp/>$embed,<sp/>$subset);</highlight></codeline>
<codeline lineno="450"><highlight class="normal">}</highlight></codeline>
<codeline lineno="451"><highlight class="normal">?&gt;</highlight></codeline>
    </programlisting>
    <location file="/var/www/html/trabajos/hospital/makefont/makefont.php"/>
  </compounddef>
</doxygen>
